<!doctype html>
<html lang="en">
<head>
<meta charset="utf-8" />
<meta name="viewport" content="width=device-width,initial-scale=1" />
<title>Paddle Smash — Black & White Arcade</title>
<style>
  :root{--bg:#fff;--fg:#000}
  html,body{height:100%;margin:0;background:var(--bg);color:var(--fg);font-family:system-ui,-apple-system,Segoe UI,Roboto,'Helvetica Neue',Arial}
  .wrap{height:100%;display:flex;align-items:center;justify-content:center}
  canvas{background:var(--bg);border:4px solid var(--fg);box-shadow:0 12px 30px rgba(0,0,0,0.08);display:block}
  #hud{position:fixed;left:18px;top:16px;font-weight:400}
  #hint{position:fixed;right:18px;top:14px;font-size:13px;opacity:0.75}
  #center{position:fixed;left:50%;top:50%;transform:translate(-50%,-50%);text-align:center}
  .btn{display:inline-block;margin-top:12px;padding:8px 12px;border:2px solid var(--fg);cursor:pointer}
  @media (max-width:600px){canvas{width:360px;height:600px}}
</style>
</head>
<body>
  <div id="hud">Score: <span id="score">0</span> &nbsp;|&nbsp; Best: <span id="best">0</span></div>
  <div id="hint">← → or A D • Space to serve • R restart</div>
  <div class="wrap">
    <canvas id="c" width="420" height="600" aria-label="Paddle Smash black and white arcade"></canvas>
  </div>
  <div id="center"></div>
<script>
// Paddle Smash — black & white arcade
const canvas = document.getElementById('c');
const ctx = canvas.getContext('2d');
const W = canvas.width, H = canvas.height;
const scoreEl = document.getElementById('score');
const bestEl = document.getElementById('best');
const center = document.getElementById('center');

// Pastel colors for ball
const pastelColors = ['#FFB6C1', '#E6E6FA', '#98FB98', '#F0E68C', '#FFA07A', '#87CEEB', '#DDA0DD', '#F5DEB3', '#90EE90', '#FFE4E1'];

// Audio helper
const ac = new (window.AudioContext||window.webkitAudioContext)();
function sfx(f=440, t=0.08, type='square', vol=0.08, glide=0){
  const o = ac.createOscillator();
  const g = ac.createGain();
  o.type = type;
  o.frequency.setValueAtTime(f, ac.currentTime);
  if(glide) o.frequency.exponentialRampToValueAtTime(f*glide, ac.currentTime+t);
  g.gain.setValueAtTime(vol, ac.currentTime);
  g.gain.exponentialRampToValueAtTime(0.001, ac.currentTime+t);
  o.connect(g); g.connect(ac.destination);
  o.start(); o.stop(ac.currentTime + t);
}

let state = {
  paddle: { w: 100, h: 14, x: (W-100)/2, y: H-60, speed: 8 },
  ball: { r: 10, x: W/2, y: H/2, vx: 0, vy: 0, speed: 6, stuck: true, trail:[], color: pastelColors[Math.floor(Math.random()*pastelColors.length)] },
  particles: [],
  score: 0,
  best: +localStorage.getItem('paddle_smash_bw_best') || 0,
  running: false,
  gameOver: false,
  screenShake: 0,
  highScoreFlash: false,
  highScoreTimer: 0,
  difficultyLevel: 1
};
bestEl.textContent = state.best;

// input
const keys = {};
window.addEventListener('keydown', e=>{ 
  keys[e.key]=true; 
  if(!state.running && !state.gameOver) serve(); 
  if(e.key==='r'||e.key==='R'){reset();}
});
window.addEventListener('keyup', e=> keys[e.key]=false);

function serve(){ if(!state.running) { state.running = true; center.innerHTML=''; }
  if(state.ball.stuck){ state.ball.stuck=false; state.ball.vx = (Math.random()*2-1)*2; state.ball.vy = -state.ball.speed; sfx(880,0.08,'square',0.08,0.5); }}

function reset(){ 
  state.paddle.x = (W-state.paddle.w)/2; 
  state.paddle.w = 100; // reset paddle size
  state.ball.x = W/2; 
  state.ball.y = state.paddle.y - 20; 
  state.ball.vx = 0; 
  state.ball.vy = 0; 
  state.ball.stuck = true; 
  state.ball.color = pastelColors[Math.floor(Math.random()*pastelColors.length)]; 
  state.ball.speed = 6; // reset ball speed
  state.score = 0; 
  state.running = false; 
  state.gameOver = false; 
  state.screenShake = 0; 
  state.highScoreFlash = false;
  state.highScoreTimer = 0;
  state.difficultyLevel = 1;
  scoreEl.textContent = '0'; 
  center.innerHTML = '<div style="font-weight:700;font-size:20px">Paddle Smash</div><div style="opacity:0.8;margin-top:8px">Move or press any key to start</div>'; 
}

function hitPaddle(){
  const p = state.paddle, b = state.ball; 
  const hit = (b.x - (p.x + p.w/2)) / (p.w/2);
  b.vx = hit * (b.speed*1.1);
  b.vy = -Math.abs(b.vy) - 0.15;
  
  // Progressive difficulty scaling
  const speedIncrease = 1.01 + (state.difficultyLevel * 0.002);
  b.speed *= speedIncrease;
  
  // Update difficulty level every 10 points
  const newLevel = Math.floor(state.score / 10) + 1;
  if(newLevel > state.difficultyLevel) {
    state.difficultyLevel = newLevel;
    // Shrink paddle slightly every 20 points
    if(state.score > 0 && state.score % 20 === 0 && state.paddle.w > 60) {
      state.paddle.w = Math.max(60, state.paddle.w - 8);
    }
  }
}

function spawnParticles(x,y,count=12){ for(let i=0;i<count;i++){ state.particles.push({x,y,vx:(Math.random()-0.5)*6, vy:(Math.random()-0.5)*6, life:1, size:2+Math.random()*3}); } }

function update(dt){ if(state.gameOver) { state.screenShake = Math.max(0, state.screenShake-0.6); state.particles.forEach(p=>{ p.x += p.vx; p.y += p.vy; p.vy += 0.12; p.life -= 0.02; }); state.particles = state.particles.filter(p=>p.life>0); return; }

  if((keys['ArrowLeft']||keys['a']||keys['A']) ) state.paddle.x = Math.max(0, state.paddle.x - state.paddle.speed);
  if((keys['ArrowRight']||keys['d']||keys['D']) ) state.paddle.x = Math.min(W-state.paddle.w, state.paddle.x + state.paddle.speed);

  // Update high score flash timer
  if(state.highScoreFlash && state.highScoreTimer > 0) {
    state.highScoreTimer -= dt;
    if(state.highScoreTimer <= 0) {
      state.highScoreFlash = false;
    }
  }

  const b = state.ball;
  if(b.stuck){ b.x = state.paddle.x + state.paddle.w/2; b.y = state.paddle.y - b.r - 2; }
  else {
    b.x += b.vx; b.y += b.vy; 
    
    // Gravity increases slightly with difficulty
    const gravity = 0.12 + (state.difficultyLevel * 0.005);
    b.vy += gravity;
    
    b.trail.push({x:b.x, y:b.y, r:b.r, life:1});
    if(b.trail.length>10) b.trail.shift();
    b.trail.forEach(t=> t.life-=0.1);
    b.trail = b.trail.filter(t=>t.life>0);
  }

  if(b.x - b.r < 0){ b.x = b.r; b.vx = -b.vx; sfx(600,0.05,'triangle',0.06); }
  if(b.x + b.r > W){ b.x = W - b.r; b.vx = -b.vx; sfx(600,0.05,'triangle',0.06); }
  if(b.y - b.r < 0){ b.y = b.r; b.vy = -b.vy; sfx(720,0.06,'square',0.07,0.8); }

  if(b.y + b.r > state.paddle.y && b.y + b.r < state.paddle.y + state.paddle.h && b.x > state.paddle.x && b.x < state.paddle.x + state.paddle.w && b.vy > 0){
    hitPaddle(); sfx(1200,0.07,'square',0.08,0.7);
    state.score += 1; 
    scoreEl.textContent = state.score;
    if(state.score > state.best){ 
      state.best = state.score; 
      bestEl.textContent = state.best; 
      localStorage.setItem('paddle_smash_bw_best', state.best); 
      // Trigger high score flash and sound
      state.highScoreFlash = true;
      state.highScoreTimer = 3500; // 3.5 seconds
      sfx(1800, 0.2, 'triangle', 0.12); // Arcade sound for new high score
    }
  }

  if(b.y - b.r > H){
    state.gameOver = true; state.running = false; state.screenShake = 18; spawnParticles(b.x, b.y, 30); sfx(160,0.4,'sawtooth',0.09,2);
    center.innerHTML = '<div style="font-weight:800;font-size:28px">Game Over</div>' +
      '<div style="margin-top:6px;font-size:18px">Score: '+state.score+'</div>' +
      '<div style="margin-top:4px;font-size:16px">Best: '+state.best+'</div>' +
      '<div style="opacity:0.85;margin-top:10px">Press R to restart</div>';
  }

  state.particles.forEach(p=>{ p.x += p.vx; p.y += p.vy; p.vy += 0.08; p.life -= 0.02; p.size *= 0.98; });
  state.particles = state.particles.filter(p=>p.life>0 && p.size>0.5);
}

function draw(){ ctx.save(); if(state.screenShake>0){ const s = state.screenShake; ctx.translate((Math.random()-0.5)*s, (Math.random()-0.5)*s); }
  ctx.clearRect(0,0,W,H);

  state.particles.forEach(p=>{ ctx.globalAlpha = Math.max(0,p.life); ctx.fillStyle='#000'; ctx.fillRect(p.x - p.size/2, p.y - p.size/2, p.size, p.size); });

  const p = state.paddle;
  ctx.globalAlpha = 1;
  ctx.fillStyle='#000';
  ctx.fillRect(p.x, p.y, p.w, p.h);

  const b = state.ball;
  b.trail.forEach(t=>{
    ctx.globalAlpha = t.life*0.3;
    ctx.beginPath();
    ctx.arc(t.x, t.y, t.r*(1+t.life*0.5), 0, Math.PI*2);
    ctx.fillStyle = b.color;
    ctx.fill();
  });
  ctx.globalAlpha = 1;
  ctx.beginPath();
  ctx.arc(b.x, b.y, b.r, 0, Math.PI*2);
  ctx.fillStyle = b.color;
  ctx.fill();

  // Draw difficulty indicator
  if(state.running) {
    ctx.fillStyle = '#666';
    ctx.font = '12px system-ui';
    ctx.textAlign = 'right';
    ctx.fillText('Level ' + state.difficultyLevel, W - 20, 35);
  }

  // Draw high score flash message
  if(state.highScoreFlash && state.highScoreTimer > 0) {
    const flashAlpha = Math.sin(Date.now() * 0.01) * 0.3 + 0.7; // Pulsing effect
    ctx.globalAlpha = flashAlpha;
    ctx.fillStyle = '#FFD700'; // Gold color
    ctx.font = 'bold 16px system-ui';
    ctx.textAlign = 'center';
    ctx.fillText('NEW HIGH SCORE!', W/2, 50);
    ctx.globalAlpha = 1;
  }

  ctx.restore();
}

let last = performance.now();
function loop(t){ const dt = t - last; last = t; update(dt); draw(); requestAnimationFrame(loop); }

center.innerHTML = '<div style="font-weight:700;font-size:20px">Paddle Smash</div><div style="opacity:0.8;margin-top:8px">Move or press any key to start</div>';
reset(); requestAnimationFrame(loop);
</script>
</body>
</html>